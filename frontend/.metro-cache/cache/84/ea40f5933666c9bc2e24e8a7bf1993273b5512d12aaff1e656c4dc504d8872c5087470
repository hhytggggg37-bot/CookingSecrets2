{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":31,"index":180}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[2], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      loadUser();\n    }, []);\n    const loadUser = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('token');\n        const userData = await AsyncStorage.default.getItem('user');\n        if (token && userData) {\n          setUser(JSON.parse(userData));\n        }\n      } catch (error) {\n        console.error('Failed to load user:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    const login = async (email, password, isStaff = false) => {\n      try {\n        const endpoint = isStaff ? '/auth/staff-login' : '/auth/login';\n        const response = await api.default.post(endpoint, {\n          email,\n          password\n        });\n        const {\n          access_token,\n          user: userData\n        } = response.data;\n        await AsyncStorage.default.setItem('token', access_token);\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Login failed');\n      }\n    };\n    const signup = async (email, password, name, role) => {\n      try {\n        const response = await api.default.post('/auth/signup', {\n          email,\n          password,\n          name,\n          role\n        });\n        const {\n          access_token,\n          user: userData\n        } = response.data;\n        await AsyncStorage.default.setItem('token', access_token);\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Signup failed');\n      }\n    };\n    const logout = async () => {\n      try {\n        // 1. Remove JWT from AsyncStorage\n        await AsyncStorage.default.removeItem('token');\n        await AsyncStorage.default.removeItem('user');\n\n        // 2. Clear axios auth headers\n        delete api.default.defaults.headers.common['Authorization'];\n\n        // 3. Reset user state\n        setUser(null);\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    const refreshUser = async () => {\n      try {\n        const response = await api.default.get('/auth/me');\n        const userData = response.data;\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        console.error('Failed to refresh user:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        loading,\n        login,\n        signup,\n        logout,\n        refreshUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }, this);\n  };\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n});","lineCount":138,"map":[[13,2,29,0,"Object"],[13,8,29,0],[13,9,29,0,"defineProperty"],[13,23,29,0],[13,24,29,0,"exports"],[13,31,29,0],[14,4,29,0,"enumerable"],[14,14,29,0],[15,4,29,0,"get"],[15,7,29,0],[15,18,29,0,"get"],[15,19,29,0],[16,6,29,0],[16,13,29,0,"AuthProvider"],[16,25,29,0],[17,4,29,0],[18,2,29,0],[19,2,118,0,"Object"],[19,8,118,0],[19,9,118,0,"defineProperty"],[19,23,118,0],[19,24,118,0,"exports"],[19,31,118,0],[20,4,118,0,"enumerable"],[20,14,118,0],[21,4,118,0,"get"],[21,7,118,0],[21,18,118,0,"get"],[21,19,118,0],[22,6,118,0],[22,13,118,0,"useAuth"],[22,20,118,0],[23,4,118,0],[24,2,118,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,3,0],[28,6,3,0,"_utilsApi"],[28,15,3,0],[28,18,3,0,"require"],[28,25,3,0],[28,26,3,0,"_dependencyMap"],[28,40,3,0],[29,2,3,0],[29,6,3,0,"api"],[29,9,3,0],[29,12,3,0,"_interopDefault"],[29,27,3,0],[29,28,3,0,"_utilsApi"],[29,37,3,0],[30,2,3,31],[30,6,3,31,"_reactJsxDevRuntime"],[30,25,3,31],[30,28,3,31,"require"],[30,35,3,31],[30,36,3,31,"_dependencyMap"],[30,50,3,31],[31,2,27,0],[31,8,27,6,"AuthContext"],[31,19,27,17],[31,35,27,20],[31,39,27,20,"createContext"],[31,45,27,33],[31,46,27,33,"createContext"],[31,59,27,33],[31,61,27,63,"undefined"],[31,70,27,72],[31,71,27,73],[32,2,29,7],[32,8,29,13,"AuthProvider"],[32,20,29,66],[32,23,29,69,"AuthProvider"],[32,24,29,70],[33,4,29,72,"children"],[34,2,29,81],[34,3,29,82],[34,8,29,87],[35,4,30,2],[35,10,30,8],[35,11,30,9,"user"],[35,15,30,13],[35,17,30,15,"setUser"],[35,24,30,22],[35,25,30,23],[35,28,30,26],[35,32,30,26,"useState"],[35,38,30,34],[35,39,30,34,"useState"],[35,47,30,34],[35,49,30,48],[35,53,30,52],[35,54,30,53],[36,4,31,2],[36,10,31,8],[36,11,31,9,"loading"],[36,18,31,16],[36,20,31,18,"setLoading"],[36,30,31,28],[36,31,31,29],[36,34,31,32],[36,38,31,32,"useState"],[36,44,31,40],[36,45,31,40,"useState"],[36,53,31,40],[36,55,31,41],[36,59,31,45],[36,60,31,46],[37,4,33,2],[37,8,33,2,"useEffect"],[37,14,33,11],[37,15,33,11,"useEffect"],[37,24,33,11],[37,26,33,12],[37,32,33,18],[38,6,34,4,"loadUser"],[38,14,34,12],[38,15,34,13],[38,16,34,14],[39,4,35,2],[39,5,35,3],[39,7,35,5],[39,9,35,7],[39,10,35,8],[40,4,37,2],[40,10,37,8,"loadUser"],[40,18,37,16],[40,21,37,19],[40,27,37,19,"loadUser"],[40,28,37,19],[40,33,37,31],[41,6,38,4],[41,10,38,8],[42,8,39,6],[42,14,39,12,"token"],[42,19,39,17],[42,22,39,20],[42,28,39,26,"AsyncStorage"],[42,40,39,38],[42,41,39,38,"default"],[42,48,39,38],[42,49,39,39,"getItem"],[42,56,39,46],[42,57,39,47],[42,64,39,54],[42,65,39,55],[43,8,40,6],[43,14,40,12,"userData"],[43,22,40,20],[43,25,40,23],[43,31,40,29,"AsyncStorage"],[43,43,40,41],[43,44,40,41,"default"],[43,51,40,41],[43,52,40,42,"getItem"],[43,59,40,49],[43,60,40,50],[43,66,40,56],[43,67,40,57],[44,8,42,6],[44,12,42,10,"token"],[44,17,42,15],[44,21,42,19,"userData"],[44,29,42,27],[44,31,42,29],[45,10,43,8,"setUser"],[45,17,43,15],[45,18,43,16,"JSON"],[45,22,43,20],[45,23,43,21,"parse"],[45,28,43,26],[45,29,43,27,"userData"],[45,37,43,35],[45,38,43,36],[45,39,43,37],[46,8,44,6],[47,6,45,4],[47,7,45,5],[47,8,45,6],[47,15,45,13,"error"],[47,20,45,18],[47,22,45,20],[48,8,46,6,"console"],[48,15,46,13],[48,16,46,14,"error"],[48,21,46,19],[48,22,46,20],[48,44,46,42],[48,46,46,44,"error"],[48,51,46,49],[48,52,46,50],[49,6,47,4],[49,7,47,5],[49,16,47,14],[50,8,48,6,"setLoading"],[50,18,48,16],[50,19,48,17],[50,24,48,22],[50,25,48,23],[51,6,49,4],[52,4,50,2],[52,5,50,3],[53,4,52,2],[53,10,52,8,"login"],[53,15,52,13],[53,18,52,16],[53,24,52,16,"login"],[53,25,52,23,"email"],[53,30,52,36],[53,32,52,38,"password"],[53,40,52,54],[53,42,52,56,"isStaff"],[53,49,52,63],[53,52,52,66],[53,57,52,71],[53,62,52,76],[54,6,53,4],[54,10,53,8],[55,8,54,6],[55,14,54,12,"endpoint"],[55,22,54,20],[55,25,54,23,"isStaff"],[55,32,54,30],[55,35,54,33],[55,54,54,52],[55,57,54,55],[55,70,54,68],[56,8,55,6],[56,14,55,12,"response"],[56,22,55,20],[56,25,55,23],[56,31,55,29,"api"],[56,34,55,32],[56,35,55,32,"default"],[56,42,55,32],[56,43,55,33,"post"],[56,47,55,37],[56,48,55,38,"endpoint"],[56,56,55,46],[56,58,55,48],[57,10,55,50,"email"],[57,15,55,55],[58,10,55,57,"password"],[59,8,55,66],[59,9,55,67],[59,10,55,68],[60,8,57,6],[60,14,57,12],[61,10,57,14,"access_token"],[61,22,57,26],[62,10,57,28,"user"],[62,14,57,32],[62,16,57,34,"userData"],[63,8,57,43],[63,9,57,44],[63,12,57,47,"response"],[63,20,57,55],[63,21,57,56,"data"],[63,25,57,60],[64,8,59,6],[64,14,59,12,"AsyncStorage"],[64,26,59,24],[64,27,59,24,"default"],[64,34,59,24],[64,35,59,25,"setItem"],[64,42,59,32],[64,43,59,33],[64,50,59,40],[64,52,59,42,"access_token"],[64,64,59,54],[64,65,59,55],[65,8,60,6],[65,14,60,12,"AsyncStorage"],[65,26,60,24],[65,27,60,24,"default"],[65,34,60,24],[65,35,60,25,"setItem"],[65,42,60,32],[65,43,60,33],[65,49,60,39],[65,51,60,41,"JSON"],[65,55,60,45],[65,56,60,46,"stringify"],[65,65,60,55],[65,66,60,56,"userData"],[65,74,60,64],[65,75,60,65],[65,76,60,66],[66,8,62,6,"setUser"],[66,15,62,13],[66,16,62,14,"userData"],[66,24,62,22],[66,25,62,23],[67,6,63,4],[67,7,63,5],[67,8,63,6],[67,15,63,13,"error"],[67,20,63,23],[67,22,63,25],[68,8,64,6],[68,14,64,12],[68,18,64,16,"Error"],[68,23,64,21],[68,24,64,22,"error"],[68,29,64,27],[68,30,64,28,"response"],[68,38,64,36],[68,40,64,38,"data"],[68,44,64,42],[68,46,64,44,"detail"],[68,52,64,50],[68,56,64,54],[68,70,64,68],[68,71,64,69],[69,6,65,4],[70,4,66,2],[70,5,66,3],[71,4,68,2],[71,10,68,8,"signup"],[71,16,68,14],[71,19,68,17],[71,25,68,17,"signup"],[71,26,68,24,"email"],[71,31,68,37],[71,33,68,39,"password"],[71,41,68,55],[71,43,68,57,"name"],[71,47,68,69],[71,49,68,71,"role"],[71,53,68,83],[71,58,68,88],[72,6,69,4],[72,10,69,8],[73,8,70,6],[73,14,70,12,"response"],[73,22,70,20],[73,25,70,23],[73,31,70,29,"api"],[73,34,70,32],[73,35,70,32,"default"],[73,42,70,32],[73,43,70,33,"post"],[73,47,70,37],[73,48,70,38],[73,62,70,52],[73,64,70,54],[74,10,70,56,"email"],[74,15,70,61],[75,10,70,63,"password"],[75,18,70,71],[76,10,70,73,"name"],[76,14,70,77],[77,10,70,79,"role"],[78,8,70,84],[78,9,70,85],[78,10,70,86],[79,8,72,6],[79,14,72,12],[80,10,72,14,"access_token"],[80,22,72,26],[81,10,72,28,"user"],[81,14,72,32],[81,16,72,34,"userData"],[82,8,72,43],[82,9,72,44],[82,12,72,47,"response"],[82,20,72,55],[82,21,72,56,"data"],[82,25,72,60],[83,8,74,6],[83,14,74,12,"AsyncStorage"],[83,26,74,24],[83,27,74,24,"default"],[83,34,74,24],[83,35,74,25,"setItem"],[83,42,74,32],[83,43,74,33],[83,50,74,40],[83,52,74,42,"access_token"],[83,64,74,54],[83,65,74,55],[84,8,75,6],[84,14,75,12,"AsyncStorage"],[84,26,75,24],[84,27,75,24,"default"],[84,34,75,24],[84,35,75,25,"setItem"],[84,42,75,32],[84,43,75,33],[84,49,75,39],[84,51,75,41,"JSON"],[84,55,75,45],[84,56,75,46,"stringify"],[84,65,75,55],[84,66,75,56,"userData"],[84,74,75,64],[84,75,75,65],[84,76,75,66],[85,8,77,6,"setUser"],[85,15,77,13],[85,16,77,14,"userData"],[85,24,77,22],[85,25,77,23],[86,6,78,4],[86,7,78,5],[86,8,78,6],[86,15,78,13,"error"],[86,20,78,23],[86,22,78,25],[87,8,79,6],[87,14,79,12],[87,18,79,16,"Error"],[87,23,79,21],[87,24,79,22,"error"],[87,29,79,27],[87,30,79,28,"response"],[87,38,79,36],[87,40,79,38,"data"],[87,44,79,42],[87,46,79,44,"detail"],[87,52,79,50],[87,56,79,54],[87,71,79,69],[87,72,79,70],[88,6,80,4],[89,4,81,2],[89,5,81,3],[90,4,83,2],[90,10,83,8,"logout"],[90,16,83,14],[90,19,83,17],[90,25,83,17,"logout"],[90,26,83,17],[90,31,83,29],[91,6,84,4],[91,10,84,8],[92,8,85,6],[93,8,86,6],[93,14,86,12,"AsyncStorage"],[93,26,86,24],[93,27,86,24,"default"],[93,34,86,24],[93,35,86,25,"removeItem"],[93,45,86,35],[93,46,86,36],[93,53,86,43],[93,54,86,44],[94,8,87,6],[94,14,87,12,"AsyncStorage"],[94,26,87,24],[94,27,87,24,"default"],[94,34,87,24],[94,35,87,25,"removeItem"],[94,45,87,35],[94,46,87,36],[94,52,87,42],[94,53,87,43],[96,8,89,6],[97,8,90,6],[97,15,90,13,"api"],[97,18,90,16],[97,19,90,16,"default"],[97,26,90,16],[97,27,90,17,"defaults"],[97,35,90,25],[97,36,90,26,"headers"],[97,43,90,33],[97,44,90,34,"common"],[97,50,90,40],[97,51,90,41],[97,66,90,56],[97,67,90,57],[99,8,92,6],[100,8,93,6,"setUser"],[100,15,93,13],[100,16,93,14],[100,20,93,18],[100,21,93,19],[101,6,94,4],[101,7,94,5],[101,8,94,6],[101,15,94,13,"error"],[101,20,94,18],[101,22,94,20],[102,8,95,6,"console"],[102,15,95,13],[102,16,95,14,"error"],[102,21,95,19],[102,22,95,20],[102,37,95,35],[102,39,95,37,"error"],[102,44,95,42],[102,45,95,43],[103,6,96,4],[104,4,97,2],[104,5,97,3],[105,4,99,2],[105,10,99,8,"refreshUser"],[105,21,99,19],[105,24,99,22],[105,30,99,22,"refreshUser"],[105,31,99,22],[105,36,99,34],[106,6,100,4],[106,10,100,8],[107,8,101,6],[107,14,101,12,"response"],[107,22,101,20],[107,25,101,23],[107,31,101,29,"api"],[107,34,101,32],[107,35,101,32,"default"],[107,42,101,32],[107,43,101,33,"get"],[107,46,101,36],[107,47,101,37],[107,57,101,47],[107,58,101,48],[108,8,102,6],[108,14,102,12,"userData"],[108,22,102,20],[108,25,102,23,"response"],[108,33,102,31],[108,34,102,32,"data"],[108,38,102,36],[109,8,104,6],[109,14,104,12,"AsyncStorage"],[109,26,104,24],[109,27,104,24,"default"],[109,34,104,24],[109,35,104,25,"setItem"],[109,42,104,32],[109,43,104,33],[109,49,104,39],[109,51,104,41,"JSON"],[109,55,104,45],[109,56,104,46,"stringify"],[109,65,104,55],[109,66,104,56,"userData"],[109,74,104,64],[109,75,104,65],[109,76,104,66],[110,8,105,6,"setUser"],[110,15,105,13],[110,16,105,14,"userData"],[110,24,105,22],[110,25,105,23],[111,6,106,4],[111,7,106,5],[111,8,106,6],[111,15,106,13,"error"],[111,20,106,18],[111,22,106,20],[112,8,107,6,"console"],[112,15,107,13],[112,16,107,14,"error"],[112,21,107,19],[112,22,107,20],[112,47,107,45],[112,49,107,47,"error"],[112,54,107,52],[112,55,107,53],[113,6,108,4],[114,4,109,2],[114,5,109,3],[115,4,111,2],[115,24,112,4],[115,28,112,4,"_reactJsxDevRuntime"],[115,47,112,4],[115,48,112,4,"jsxDEV"],[115,54,112,4],[115,56,112,5,"AuthContext"],[115,67,112,16],[115,68,112,17,"Provider"],[115,76,112,25],[116,6,112,26,"value"],[116,11,112,31],[116,13,112,33],[117,8,112,35,"user"],[117,12,112,39],[118,8,112,41,"loading"],[118,15,112,48],[119,8,112,50,"login"],[119,13,112,55],[120,8,112,57,"signup"],[120,14,112,63],[121,8,112,65,"logout"],[121,14,112,71],[122,8,112,73,"refreshUser"],[123,6,112,85],[123,7,112,87],[124,6,112,87,"children"],[124,14,112,87],[124,16,113,7,"children"],[125,4,113,15],[126,6,113,15,"fileName"],[126,14,113,15],[126,16,113,15,"_jsxFileName"],[126,28,113,15],[127,6,113,15,"lineNumber"],[127,16,113,15],[128,6,113,15,"columnNumber"],[128,18,113,15],[129,4,113,15],[129,11,114,26],[129,12,114,27],[130,2,116,0],[130,3,116,1],[131,2,118,7],[131,8,118,13,"useAuth"],[131,15,118,20],[131,18,118,23,"useAuth"],[131,19,118,23],[131,24,118,29],[132,4,119,2],[132,10,119,8,"context"],[132,17,119,15],[132,20,119,18],[132,24,119,18,"useContext"],[132,30,119,28],[132,31,119,28,"useContext"],[132,41,119,28],[132,43,119,29,"AuthContext"],[132,54,119,40],[132,55,119,41],[133,4,120,2],[133,8,120,6,"context"],[133,15,120,13],[133,20,120,18,"undefined"],[133,29,120,27],[133,31,120,29],[134,6,121,4],[134,12,121,10],[134,16,121,14,"Error"],[134,21,121,19],[134,22,121,20],[134,67,121,65],[134,68,121,66],[135,4,122,2],[136,4,123,2],[136,11,123,9,"context"],[136,18,123,16],[137,2,124,0],[137,3,124,1],[138,0,124,2],[138,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadUser","login","signup","logout","refreshUser","useAuth"],"mappings":"AAA;qEC4B;YCI;GDE;mBEE;GFa;gBGE;GHc;iBIE;GJa;iBKE;GLc;sBME;GNU;CDO;uBQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}