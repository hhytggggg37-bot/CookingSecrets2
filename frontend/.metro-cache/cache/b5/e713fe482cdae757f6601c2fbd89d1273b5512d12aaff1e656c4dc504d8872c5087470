{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":31,"index":180}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[2], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    _s();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      loadUser();\n    }, []);\n    const loadUser = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('token');\n        const userData = await AsyncStorage.default.getItem('user');\n        if (token && userData) {\n          setUser(JSON.parse(userData));\n        }\n      } catch (error) {\n        console.error('Failed to load user:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    const login = async (email, password, isStaff = false) => {\n      try {\n        const endpoint = isStaff ? '/auth/staff-login' : '/auth/login';\n        const response = await api.default.post(endpoint, {\n          email,\n          password\n        });\n        const {\n          access_token,\n          user: userData\n        } = response.data;\n        await AsyncStorage.default.setItem('token', access_token);\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Login failed');\n      }\n    };\n    const signup = async (email, password, name, role) => {\n      try {\n        const response = await api.default.post('/auth/signup', {\n          email,\n          password,\n          name,\n          role\n        });\n        const {\n          access_token,\n          user: userData\n        } = response.data;\n        await AsyncStorage.default.setItem('token', access_token);\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Signup failed');\n      }\n    };\n    const logout = async () => {\n      try {\n        // 1. Remove JWT from AsyncStorage\n        await AsyncStorage.default.removeItem('token');\n        await AsyncStorage.default.removeItem('user');\n\n        // 2. Clear axios auth headers\n        delete api.default.defaults.headers.common['Authorization'];\n\n        // 3. Reset user state\n        setUser(null);\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    const refreshUser = async () => {\n      try {\n        const response = await api.default.get('/auth/me');\n        const userData = response.data;\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        console.error('Failed to refresh user:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        loading,\n        login,\n        signup,\n        logout,\n        refreshUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }, this);\n  };\n  _s(AuthProvider, \"NiO5z6JIqzX62LS5UWDgIqbZYyY=\");\n  _c = AuthProvider;\n  const useAuth = () => {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":147,"map":[[15,2,29,0,"Object"],[15,8,29,0],[15,9,29,0,"defineProperty"],[15,23,29,0],[15,24,29,0,"exports"],[15,31,29,0],[16,4,29,0,"enumerable"],[16,14,29,0],[17,4,29,0,"get"],[17,7,29,0],[17,18,29,0,"get"],[17,19,29,0],[18,6,29,0],[18,13,29,0,"AuthProvider"],[18,25,29,0],[19,4,29,0],[20,2,29,0],[21,2,118,0,"Object"],[21,8,118,0],[21,9,118,0,"defineProperty"],[21,23,118,0],[21,24,118,0,"exports"],[21,31,118,0],[22,4,118,0,"enumerable"],[22,14,118,0],[23,4,118,0,"get"],[23,7,118,0],[23,18,118,0,"get"],[23,19,118,0],[24,6,118,0],[24,13,118,0,"useAuth"],[24,20,118,0],[25,4,118,0],[26,2,118,0],[27,2,1,0],[27,6,1,0,"_react"],[27,12,1,0],[27,15,1,0,"require"],[27,22,1,0],[27,23,1,0,"_dependencyMap"],[27,37,1,0],[28,2,2,0],[28,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[28,42,2,0],[28,45,2,0,"require"],[28,52,2,0],[28,53,2,0,"_dependencyMap"],[28,67,2,0],[29,2,2,0],[29,6,2,0,"AsyncStorage"],[29,18,2,0],[29,21,2,0,"_interopDefault"],[29,36,2,0],[29,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[29,73,2,0],[30,2,3,0],[30,6,3,0,"_utilsApi"],[30,15,3,0],[30,18,3,0,"require"],[30,25,3,0],[30,26,3,0,"_dependencyMap"],[30,40,3,0],[31,2,3,0],[31,6,3,0,"api"],[31,9,3,0],[31,12,3,0,"_interopDefault"],[31,27,3,0],[31,28,3,0,"_utilsApi"],[31,37,3,0],[32,2,3,31],[32,6,3,31,"_reactJsxDevRuntime"],[32,25,3,31],[32,28,3,31,"require"],[32,35,3,31],[32,36,3,31,"_dependencyMap"],[32,50,3,31],[33,2,27,0],[33,8,27,6,"AuthContext"],[33,19,27,17],[33,35,27,20],[33,39,27,20,"createContext"],[33,45,27,33],[33,46,27,33,"createContext"],[33,59,27,33],[33,61,27,63,"undefined"],[33,70,27,72],[33,71,27,73],[34,2,29,7],[34,8,29,13,"AuthProvider"],[34,20,29,66],[34,23,29,69,"AuthProvider"],[34,24,29,70],[35,4,29,72,"children"],[36,2,29,81],[36,3,29,82],[36,8,29,87],[37,4,29,87,"_s"],[37,6,29,87],[38,4,30,2],[38,10,30,8],[38,11,30,9,"user"],[38,15,30,13],[38,17,30,15,"setUser"],[38,24,30,22],[38,25,30,23],[38,28,30,26],[38,32,30,26,"useState"],[38,38,30,34],[38,39,30,34,"useState"],[38,47,30,34],[38,49,30,48],[38,53,30,52],[38,54,30,53],[39,4,31,2],[39,10,31,8],[39,11,31,9,"loading"],[39,18,31,16],[39,20,31,18,"setLoading"],[39,30,31,28],[39,31,31,29],[39,34,31,32],[39,38,31,32,"useState"],[39,44,31,40],[39,45,31,40,"useState"],[39,53,31,40],[39,55,31,41],[39,59,31,45],[39,60,31,46],[40,4,33,2],[40,8,33,2,"useEffect"],[40,14,33,11],[40,15,33,11,"useEffect"],[40,24,33,11],[40,26,33,12],[40,32,33,18],[41,6,34,4,"loadUser"],[41,14,34,12],[41,15,34,13],[41,16,34,14],[42,4,35,2],[42,5,35,3],[42,7,35,5],[42,9,35,7],[42,10,35,8],[43,4,37,2],[43,10,37,8,"loadUser"],[43,18,37,16],[43,21,37,19],[43,27,37,19,"loadUser"],[43,28,37,19],[43,33,37,31],[44,6,38,4],[44,10,38,8],[45,8,39,6],[45,14,39,12,"token"],[45,19,39,17],[45,22,39,20],[45,28,39,26,"AsyncStorage"],[45,40,39,38],[45,41,39,38,"default"],[45,48,39,38],[45,49,39,39,"getItem"],[45,56,39,46],[45,57,39,47],[45,64,39,54],[45,65,39,55],[46,8,40,6],[46,14,40,12,"userData"],[46,22,40,20],[46,25,40,23],[46,31,40,29,"AsyncStorage"],[46,43,40,41],[46,44,40,41,"default"],[46,51,40,41],[46,52,40,42,"getItem"],[46,59,40,49],[46,60,40,50],[46,66,40,56],[46,67,40,57],[47,8,42,6],[47,12,42,10,"token"],[47,17,42,15],[47,21,42,19,"userData"],[47,29,42,27],[47,31,42,29],[48,10,43,8,"setUser"],[48,17,43,15],[48,18,43,16,"JSON"],[48,22,43,20],[48,23,43,21,"parse"],[48,28,43,26],[48,29,43,27,"userData"],[48,37,43,35],[48,38,43,36],[48,39,43,37],[49,8,44,6],[50,6,45,4],[50,7,45,5],[50,8,45,6],[50,15,45,13,"error"],[50,20,45,18],[50,22,45,20],[51,8,46,6,"console"],[51,15,46,13],[51,16,46,14,"error"],[51,21,46,19],[51,22,46,20],[51,44,46,42],[51,46,46,44,"error"],[51,51,46,49],[51,52,46,50],[52,6,47,4],[52,7,47,5],[52,16,47,14],[53,8,48,6,"setLoading"],[53,18,48,16],[53,19,48,17],[53,24,48,22],[53,25,48,23],[54,6,49,4],[55,4,50,2],[55,5,50,3],[56,4,52,2],[56,10,52,8,"login"],[56,15,52,13],[56,18,52,16],[56,24,52,16,"login"],[56,25,52,23,"email"],[56,30,52,36],[56,32,52,38,"password"],[56,40,52,54],[56,42,52,56,"isStaff"],[56,49,52,63],[56,52,52,66],[56,57,52,71],[56,62,52,76],[57,6,53,4],[57,10,53,8],[58,8,54,6],[58,14,54,12,"endpoint"],[58,22,54,20],[58,25,54,23,"isStaff"],[58,32,54,30],[58,35,54,33],[58,54,54,52],[58,57,54,55],[58,70,54,68],[59,8,55,6],[59,14,55,12,"response"],[59,22,55,20],[59,25,55,23],[59,31,55,29,"api"],[59,34,55,32],[59,35,55,32,"default"],[59,42,55,32],[59,43,55,33,"post"],[59,47,55,37],[59,48,55,38,"endpoint"],[59,56,55,46],[59,58,55,48],[60,10,55,50,"email"],[60,15,55,55],[61,10,55,57,"password"],[62,8,55,66],[62,9,55,67],[62,10,55,68],[63,8,57,6],[63,14,57,12],[64,10,57,14,"access_token"],[64,22,57,26],[65,10,57,28,"user"],[65,14,57,32],[65,16,57,34,"userData"],[66,8,57,43],[66,9,57,44],[66,12,57,47,"response"],[66,20,57,55],[66,21,57,56,"data"],[66,25,57,60],[67,8,59,6],[67,14,59,12,"AsyncStorage"],[67,26,59,24],[67,27,59,24,"default"],[67,34,59,24],[67,35,59,25,"setItem"],[67,42,59,32],[67,43,59,33],[67,50,59,40],[67,52,59,42,"access_token"],[67,64,59,54],[67,65,59,55],[68,8,60,6],[68,14,60,12,"AsyncStorage"],[68,26,60,24],[68,27,60,24,"default"],[68,34,60,24],[68,35,60,25,"setItem"],[68,42,60,32],[68,43,60,33],[68,49,60,39],[68,51,60,41,"JSON"],[68,55,60,45],[68,56,60,46,"stringify"],[68,65,60,55],[68,66,60,56,"userData"],[68,74,60,64],[68,75,60,65],[68,76,60,66],[69,8,62,6,"setUser"],[69,15,62,13],[69,16,62,14,"userData"],[69,24,62,22],[69,25,62,23],[70,6,63,4],[70,7,63,5],[70,8,63,6],[70,15,63,13,"error"],[70,20,63,23],[70,22,63,25],[71,8,64,6],[71,14,64,12],[71,18,64,16,"Error"],[71,23,64,21],[71,24,64,22,"error"],[71,29,64,27],[71,30,64,28,"response"],[71,38,64,36],[71,40,64,38,"data"],[71,44,64,42],[71,46,64,44,"detail"],[71,52,64,50],[71,56,64,54],[71,70,64,68],[71,71,64,69],[72,6,65,4],[73,4,66,2],[73,5,66,3],[74,4,68,2],[74,10,68,8,"signup"],[74,16,68,14],[74,19,68,17],[74,25,68,17,"signup"],[74,26,68,24,"email"],[74,31,68,37],[74,33,68,39,"password"],[74,41,68,55],[74,43,68,57,"name"],[74,47,68,69],[74,49,68,71,"role"],[74,53,68,83],[74,58,68,88],[75,6,69,4],[75,10,69,8],[76,8,70,6],[76,14,70,12,"response"],[76,22,70,20],[76,25,70,23],[76,31,70,29,"api"],[76,34,70,32],[76,35,70,32,"default"],[76,42,70,32],[76,43,70,33,"post"],[76,47,70,37],[76,48,70,38],[76,62,70,52],[76,64,70,54],[77,10,70,56,"email"],[77,15,70,61],[78,10,70,63,"password"],[78,18,70,71],[79,10,70,73,"name"],[79,14,70,77],[80,10,70,79,"role"],[81,8,70,84],[81,9,70,85],[81,10,70,86],[82,8,72,6],[82,14,72,12],[83,10,72,14,"access_token"],[83,22,72,26],[84,10,72,28,"user"],[84,14,72,32],[84,16,72,34,"userData"],[85,8,72,43],[85,9,72,44],[85,12,72,47,"response"],[85,20,72,55],[85,21,72,56,"data"],[85,25,72,60],[86,8,74,6],[86,14,74,12,"AsyncStorage"],[86,26,74,24],[86,27,74,24,"default"],[86,34,74,24],[86,35,74,25,"setItem"],[86,42,74,32],[86,43,74,33],[86,50,74,40],[86,52,74,42,"access_token"],[86,64,74,54],[86,65,74,55],[87,8,75,6],[87,14,75,12,"AsyncStorage"],[87,26,75,24],[87,27,75,24,"default"],[87,34,75,24],[87,35,75,25,"setItem"],[87,42,75,32],[87,43,75,33],[87,49,75,39],[87,51,75,41,"JSON"],[87,55,75,45],[87,56,75,46,"stringify"],[87,65,75,55],[87,66,75,56,"userData"],[87,74,75,64],[87,75,75,65],[87,76,75,66],[88,8,77,6,"setUser"],[88,15,77,13],[88,16,77,14,"userData"],[88,24,77,22],[88,25,77,23],[89,6,78,4],[89,7,78,5],[89,8,78,6],[89,15,78,13,"error"],[89,20,78,23],[89,22,78,25],[90,8,79,6],[90,14,79,12],[90,18,79,16,"Error"],[90,23,79,21],[90,24,79,22,"error"],[90,29,79,27],[90,30,79,28,"response"],[90,38,79,36],[90,40,79,38,"data"],[90,44,79,42],[90,46,79,44,"detail"],[90,52,79,50],[90,56,79,54],[90,71,79,69],[90,72,79,70],[91,6,80,4],[92,4,81,2],[92,5,81,3],[93,4,83,2],[93,10,83,8,"logout"],[93,16,83,14],[93,19,83,17],[93,25,83,17,"logout"],[93,26,83,17],[93,31,83,29],[94,6,84,4],[94,10,84,8],[95,8,85,6],[96,8,86,6],[96,14,86,12,"AsyncStorage"],[96,26,86,24],[96,27,86,24,"default"],[96,34,86,24],[96,35,86,25,"removeItem"],[96,45,86,35],[96,46,86,36],[96,53,86,43],[96,54,86,44],[97,8,87,6],[97,14,87,12,"AsyncStorage"],[97,26,87,24],[97,27,87,24,"default"],[97,34,87,24],[97,35,87,25,"removeItem"],[97,45,87,35],[97,46,87,36],[97,52,87,42],[97,53,87,43],[99,8,89,6],[100,8,90,6],[100,15,90,13,"api"],[100,18,90,16],[100,19,90,16,"default"],[100,26,90,16],[100,27,90,17,"defaults"],[100,35,90,25],[100,36,90,26,"headers"],[100,43,90,33],[100,44,90,34,"common"],[100,50,90,40],[100,51,90,41],[100,66,90,56],[100,67,90,57],[102,8,92,6],[103,8,93,6,"setUser"],[103,15,93,13],[103,16,93,14],[103,20,93,18],[103,21,93,19],[104,6,94,4],[104,7,94,5],[104,8,94,6],[104,15,94,13,"error"],[104,20,94,18],[104,22,94,20],[105,8,95,6,"console"],[105,15,95,13],[105,16,95,14,"error"],[105,21,95,19],[105,22,95,20],[105,37,95,35],[105,39,95,37,"error"],[105,44,95,42],[105,45,95,43],[106,6,96,4],[107,4,97,2],[107,5,97,3],[108,4,99,2],[108,10,99,8,"refreshUser"],[108,21,99,19],[108,24,99,22],[108,30,99,22,"refreshUser"],[108,31,99,22],[108,36,99,34],[109,6,100,4],[109,10,100,8],[110,8,101,6],[110,14,101,12,"response"],[110,22,101,20],[110,25,101,23],[110,31,101,29,"api"],[110,34,101,32],[110,35,101,32,"default"],[110,42,101,32],[110,43,101,33,"get"],[110,46,101,36],[110,47,101,37],[110,57,101,47],[110,58,101,48],[111,8,102,6],[111,14,102,12,"userData"],[111,22,102,20],[111,25,102,23,"response"],[111,33,102,31],[111,34,102,32,"data"],[111,38,102,36],[112,8,104,6],[112,14,104,12,"AsyncStorage"],[112,26,104,24],[112,27,104,24,"default"],[112,34,104,24],[112,35,104,25,"setItem"],[112,42,104,32],[112,43,104,33],[112,49,104,39],[112,51,104,41,"JSON"],[112,55,104,45],[112,56,104,46,"stringify"],[112,65,104,55],[112,66,104,56,"userData"],[112,74,104,64],[112,75,104,65],[112,76,104,66],[113,8,105,6,"setUser"],[113,15,105,13],[113,16,105,14,"userData"],[113,24,105,22],[113,25,105,23],[114,6,106,4],[114,7,106,5],[114,8,106,6],[114,15,106,13,"error"],[114,20,106,18],[114,22,106,20],[115,8,107,6,"console"],[115,15,107,13],[115,16,107,14,"error"],[115,21,107,19],[115,22,107,20],[115,47,107,45],[115,49,107,47,"error"],[115,54,107,52],[115,55,107,53],[116,6,108,4],[117,4,109,2],[117,5,109,3],[118,4,111,2],[118,24,112,4],[118,28,112,4,"_reactJsxDevRuntime"],[118,47,112,4],[118,48,112,4,"jsxDEV"],[118,54,112,4],[118,56,112,5,"AuthContext"],[118,67,112,16],[118,68,112,17,"Provider"],[118,76,112,25],[119,6,112,26,"value"],[119,11,112,31],[119,13,112,33],[120,8,112,35,"user"],[120,12,112,39],[121,8,112,41,"loading"],[121,15,112,48],[122,8,112,50,"login"],[122,13,112,55],[123,8,112,57,"signup"],[123,14,112,63],[124,8,112,65,"logout"],[124,14,112,71],[125,8,112,73,"refreshUser"],[126,6,112,85],[126,7,112,87],[127,6,112,87,"children"],[127,14,112,87],[127,16,113,7,"children"],[128,4,113,15],[129,6,113,15,"fileName"],[129,14,113,15],[129,16,113,15,"_jsxFileName"],[129,28,113,15],[130,6,113,15,"lineNumber"],[130,16,113,15],[131,6,113,15,"columnNumber"],[131,18,113,15],[132,4,113,15],[132,11,114,26],[132,12,114,27],[133,2,116,0],[133,3,116,1],[134,2,116,2,"_s"],[134,4,116,2],[134,5,29,13,"AuthProvider"],[134,17,29,66],[135,2,29,66,"_c"],[135,4,29,66],[135,7,29,13,"AuthProvider"],[135,19,29,66],[136,2,118,7],[136,8,118,13,"useAuth"],[136,15,118,20],[136,18,118,23,"useAuth"],[136,19,118,23],[136,24,118,29],[137,4,118,29,"_s2"],[137,7,118,29],[138,4,119,2],[138,10,119,8,"context"],[138,17,119,15],[138,20,119,18],[138,24,119,18,"useContext"],[138,30,119,28],[138,31,119,28,"useContext"],[138,41,119,28],[138,43,119,29,"AuthContext"],[138,54,119,40],[138,55,119,41],[139,4,120,2],[139,8,120,6,"context"],[139,15,120,13],[139,20,120,18,"undefined"],[139,29,120,27],[139,31,120,29],[140,6,121,4],[140,12,121,10],[140,16,121,14,"Error"],[140,21,121,19],[140,22,121,20],[140,67,121,65],[140,68,121,66],[141,4,122,2],[142,4,123,2],[142,11,123,9,"context"],[142,18,123,16],[143,2,124,0],[143,3,124,1],[144,2,124,2,"_s2"],[144,5,124,2],[144,6,118,13,"useAuth"],[144,13,118,20],[145,2,118,20],[145,6,118,20,"_c"],[145,8,118,20],[146,2,118,20,"$RefreshReg$"],[146,14,118,20],[146,15,118,20,"_c"],[146,17,118,20],[147,0,118,20],[147,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadUser","login","signup","logout","refreshUser","useAuth"],"mappings":"AAA;qEC4B;YCI;GDE;mBEE;GFa;gBGE;GHc;iBIE;GJa;iBKE;GLc;sBME;GNU;CDO;uBQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}